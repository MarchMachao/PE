<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.vito.coding.check.mapper.StudentDao">

	<!-- 根据学号查询学生的数据 -->
	<select id="findStudentById" parameterType="String" resultType="Student">
		SELECT
			a_student.id,
			a_student.`name`,
			a_student.gender,
			a_student.school,
			a_student.grade,
			a_student.state,
			a_student.classes,
			a_student.duration,
			a_student.state,
			a_student.teacher
		FROM
			a_student
		WHERE
			a_student.id = #{value}
	</select>
	<!-- 根据学号查询学生的师生绑定数据 -->
	<select id="findStudentToTeacherById" parameterType="String" resultType="StudentAndItsTeacher">
		SELECT
			subjectid,
			subjectname,
			teacher AS newTeacher,
			`year`
		FROM
			a_teacher
		WHERE
			studentid = #{value}
		and `year`=(SELECT MAX(`year`)FROM a_teacher)
	</select>

	<!-- 查询数据 -->	
	
	<select id="findAllDataById" parameterType="String" resultType="data">
		select * from a_data where a_data.id = #{value} and a_data.first_check="已审核" and a_data.second_check="已审核" 
		order by a_data.year
	</select>
	
	<!-- 更新班级信息 -->
	<update id="updateData" parameterType="Student">
		update a_student
		<set>
			<if test="classes!=null">
				classes = #{classes},
			</if>
		</set>
		where id=#{id}
	</update>
	
</mapper>